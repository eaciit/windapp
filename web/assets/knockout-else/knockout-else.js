!function(a,b){"function"==typeof define&&define.amd?define(["knockout"],b):"object"==typeof exports?module.exports=b(require("knockout")):a.KnockoutElse=b(a.ko)}(this,function(a){function b(a){return u.test(a.nodeValue)}function c(a){return v.test(a.nodeValue)}function d(b,c){return function(){return!e(c)&&!a.unwrap(b())}}function e(b){return a.contextFor(w.firstChild(b)).__elseChainIsSatisfied__()}function f(b,c){for(var d,e,f,g=n.length-1;g>=0;--g)if(d=n[g],e=c[d])return f=o[d].call(this,e,b),f&&a.computed({read:f,disposeWhenNodeIsRemoved:b})}function g(a){var d=0;do if(8===a.nodeType)if(b(a)){if(0==--d)return a}else c(a)&&d++;while(a=a.previousSibling)}function h(b,c){var d,e;do b=b.previousSibling;while(b&&1!==b.nodeType&&8!==b.nodeType);if(!b)throw new Error("Knockout-else binding was not preceded by a conditional.");if(8==b.nodeType&&(b=g(b)),d=a.bindingProvider.instance.getBindingAccessors(b,c),!d||!(e=f(b,d)))throw new Error("Knockout-else binding was not preceded by a conditional.");return{conditional:e,bindings:d,node:b}}function i(a){var b,c=w.firstChild(a);do b=c;while(c=w.nextSibling(c));return b}function j(a){var b;w.firstChild(a)||w.setDomNodeChildren(a,[document.createComment("strut")]),w.insertAfter(a,document.createComment("/ko"),i(a)),b=t?document.createComment("ko "+x.if+": __elseCondition__"):document.createComment("ko if: __elseCondition__"),w.prepend(a,b)}function k(b,c,d,e){return j(b,c),a.applyBindingsToDescendants(d.extend(e),b),{controlsDescendantBindings:!0}}function l(b){var c=x[b],d=a.bindingHandlers[b];if(a.bindingHandlers[b].originalHandler)throw new Error("Knockout-else replaceBinding cannot be applied twice.");a.bindingHandlers[c]=d,a.bindingHandlers[b]={originalHandler:d,init:function(b,d,e,f,g){var h,i=document.createComment("ko "+c+": __elseWrapperValueAccessor__()"),j=document.createComment("/ko"),k=w.firstChild(b),l=null;if(k)do 8===k.nodeType&&(y.test(k.nodeValue)?(w.insertAfter(b,document.createComment("ko else"),l),w.insertAfter(b,document.createComment("/ko"),l),k.nodeValue=""):(h=z.exec(k.nodeValue))&&(w.insertAfter(b,document.createComment("ko elseif: "+h[1]),l),w.insertAfter(b,document.createComment("/ko"),l),k.nodeValue="")),l=k;while(k=w.nextSibling(k));w.insertAfter(b,j,l),w.prepend(b,i);var m={__elseWrapperValueAccessor__:d};return a.applyBindingsToDescendants(g.extend(m),b),{controlsDescendantBindings:!0}},makeTemplateValueAccessor:d.makeTemplateValueAccessor},w.allowedBindings[c]=!0}function m(b){b||(b={}),t=!!b.hasOwnProperty("inlineElse")&&b.inlineElse,r=b.hasOwnProperty("elseBinding")?b.elseBinding:"else",s=b.hasOwnProperty("elseIfBinding")?b.elseIfBinding:"elseif",r&&(a.bindingHandlers[r]=p,w.allowedBindings[r]=!0),s&&(a.bindingHandlers[s]=q,w.allowedBindings[s]=!0,o[s]=d),t&&(l("if"),l("ifnot"),l("foreach")),n=Object.keys(o)}var n,o,p,q,r,s,t,u=/^(<!--)?\s*ko\s+[\s\S]+/,v=/^(<!--)?\s*\/ko/,w=a.virtualElements,x={if:"__ko_if",ifnot:"__ko_ifnot",template:"__ko_template",foreach:"__ko_foreach"};o={if:function(b){return function(){return!a.unwrap(b())}},ifnot:function(b){return function(){return a.unwrap(b())}},foreach:function(b){return function(){var c=a.unwrap(b());return!c||0==c.length}},template:function(b){if(b().hasOwnProperty("if")||b().hasOwnProperty("foreach"))return function(){var c=b(),d=a.unwrap(c.if);if(d)return!d;var e=a.unwrap(c.foreach);return!Boolean(e&&e.length)}}},o[x.if]=o.if,o[x.ifnot]=o.if,o[x.template]=o.template,o[x.foreach]=o.foreach,p={init:function(a,b,c,d,e){if(void 0!==b())throw new Error("Knockout-else binding must be bare (i.e. no value given).");var f=h(a,e);return k(a,f.conditional,e,{__elseCondition__:f.conditional})}},q={init:function(b,c,d,f,g){var i,j,l;return i=h(b,g),l=a.computed({disposeWhenNodeIsRemoved:b,read:function(){return!i.conditional()||!(!i.bindings[s]||!e(i.node))}}),j=a.computed({disposeWhenNodeIsRemoved:b,read:function(){return Boolean(a.unwrap(c())&&i.conditional())}}),k(b,j,g,{__elseCondition__:j,__elseChainIsSatisfied__:l})}};var y=/^\s*else\s*$/,z=/^\s*else\s*if:\s*([\s\S]+)$/;return{init:m}});